<!DOCTYPE html>
<html>
<body>

<h2>Waiting for Scan...</h2>
<div id="result"></div>

<script type="module">
import { createClient } from 'https://cdn.skypack.dev/@supabase/supabase-js'

const supabase = createClient(
  'YOUR_SUPABASE_URL',
  'YOUR_PUBLIC_ANON_KEY'
)

const sessionId = "ABC123" // generate dynamically

supabase
  .channel('scan-listener')
  .on(
    'postgres_changes',
    {
      event: 'INSERT',
      schema: 'public',
      table: 'scans'
    },
    payload => {
      if (payload.new.session_id === sessionId) {
        document.getElementById('result').innerText = payload.new.data
      }
    }
  )
  .subscribe()

</script>

</body>
</html>